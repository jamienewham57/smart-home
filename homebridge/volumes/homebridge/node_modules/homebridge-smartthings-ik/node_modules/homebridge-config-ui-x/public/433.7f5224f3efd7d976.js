"use strict";(self.webpackChunkui=self.webpackChunkui||[]).push([[433],{17433:(_n,C,o)=>{o.r(C),o.d(C,{PluginsModule:()=>mn});var g=o(36895),r=o(24006),p=o(54463),c=o(8304),k=o(40294),$=o(63991),f=o(57750),u=o(15861),I=o(95698),m=o(97858),n=o(94650),x=o(92503),Z=o(79274),P=o(45417),v=o(9891),T=o(97185),A=o(48703),y=o(81862);function w(i,l){if(1&i&&(n.TgZ(0,"li",12)(1,"a",13),n._UZ(2,"i",14),n._uU(3),n.qZA()()),2&i){const t=l.$implicit,e=n.oxw();n.xp6(1),n.Q6J("href",t.url,n.LSH),n.xp6(1),n.Q6J("ngClass",e.getIconClass(t.type)),n.xp6(1),n.hij(" ",t.url," ")}}const B=function(i){return{author:i}};let J=(()=>{class i{constructor(t){this.activeModal=t}ngOnInit(){this.plugin.funding||this.activeModal.close(),Array.isArray(this.plugin.funding)?this.fundingOptions=this.plugin.funding.map(t=>"string"==typeof t?{type:"other",url:t}:"object"==typeof t?{type:t.type||"other",url:t.url}:void 0):"string"==typeof this.plugin.funding?this.fundingOptions=[{type:"other",url:this.plugin.funding}]:"object"==typeof this.plugin.funding&&(this.fundingOptions=[{type:this.plugin.funding.type||"other",url:this.plugin.funding.url}])}getIconClass(t){switch(t.toLowerCase()){case"paypal":return"fab fa-paypal";case"github":return"fab fa-github";case"patreon":return"fab fa-patreon";case"kofi":case"ko-fi":return"fas fa-coffee";default:return"fas fa-link"}}}return i.\u0275fac=function(t){return new(t||i)(n.Y36(c.Kz))},i.\u0275cmp=n.Xpm({type:i,selectors:[["app-donate-modal"]],inputs:{plugin:"plugin"},decls:14,vars:4,consts:[[1,"modal-content"],[1,"modal-header"],["translate","plugins.donate.tile_donate_to",1,"modal-title",3,"translateParams"],["type","button","data-dismiss","modal","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"modal-body"],[1,"list-group"],["class","list-group-item",4,"ngFor","ngForOf"],[1,"modal-footer"],[1,"w-100","text-right"],[1,"small","mb-0"],["href","https://github.com/homebridge/homebridge-config-ui-x/wiki/Developers:-Donation-Links","target","_blank","rel","noopener noreferrer","translate","plugins.donate.message_learn_more",1,"font-italic"],[1,"list-group-item"],["target","_blank","rel","noopener noreferrer",1,"text-break-all",3,"href"],[1,"mr-2","primary-text","fa-fw",3,"ngClass"]],template:function(t,e){1&t&&(n.TgZ(0,"div",0)(1,"div",1),n._UZ(2,"h5",2),n.TgZ(3,"button",3),n.NdJ("click",function(){return e.activeModal.dismiss("Cross click")}),n.TgZ(4,"span",4),n._uU(5,"\xd7"),n.qZA()()(),n.TgZ(6,"form")(7,"div",5)(8,"ul",6),n.YNc(9,w,4,3,"li",7),n.qZA()(),n.TgZ(10,"div",8)(11,"div",9)(12,"p",10),n._UZ(13,"a",11),n.qZA()()()()()),2&t&&(n.xp6(2),n.Q6J("translateParams",n.VKq(2,B,e.plugin.author||e.plugin.name)),n.xp6(7),n.Q6J("ngForOf",e.fundingOptions))},dependencies:[g.mk,g.sg,r._Y,r.JL,r.F,p.Pi],styles:[".text-break-all[_ngcontent-%COMP%]{word-break:break-all}"]}),i})();var U=o(37319),N=o(58605);let M=(()=>{class i{transform(t,e,a){const s=new RegExp(e,"g");return t.replace(s,a)}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275pipe=n.Yjl({name:"replace",type:i,pure:!0}),i})();function Y(i,l){1&i&&(n.TgZ(0,"p",22),n._uU(1," Installed "),n.qZA()),2&i&&n.Q6J("translate","plugins.status_installed")}function S(i,l){1&i&&(n.TgZ(0,"p",23),n._uU(1," Not Installed "),n.qZA()),2&i&&n.Q6J("translate","plugins.status_not_installed")}function Q(i,l){1&i&&(n.TgZ(0,"p",24),n._UZ(1,"i",25),n._uU(2),n.ALo(3,"translate"),n.qZA()),2&i&&(n.xp6(2),n.hij(" ",n.lcZ(3,1,"plugins.status_update_available")," "))}function j(i,l){1&i&&(n.TgZ(0,"p",26),n._UZ(1,"i",27),n._uU(2),n.ALo(3,"translate"),n.qZA()),2&i&&(n.xp6(2),n.hij(" ",n.lcZ(3,1,"plugins.status_disabled")," "))}function F(i,l){if(1&i&&(n.TgZ(0,"p",28)(1,"a",29),n._uU(2),n.qZA()()),2&i){const t=n.oxw();n.xp6(1),n.Q6J("href","https://www.npmjs.com/~"+t.plugin.author,n.LSH),n.xp6(1),n.hij("@",t.plugin.author,"")}}function L(i,l){if(1&i){const t=n.EpF();n.TgZ(0,"a",35),n.NdJ("click",function(){n.CHM(t);const a=n.oxw(2);return n.KtG(a.openFundingModal(a.plugin))}),n.TgZ(1,"span",36),n._UZ(2,"i",37),n._uU(3),n.ALo(4,"translate"),n.qZA()()}2&i&&(n.xp6(3),n.hij(" ",n.lcZ(4,1,"plugins.donate.button_donate")," "))}function q(i,l){if(1&i&&(n.TgZ(0,"p",28),n.YNc(1,L,5,3,"a",30),n.TgZ(2,"a",31)(3,"span",32),n._UZ(4,"i",33),n.TgZ(5,"span",34),n._uU(6," Verified"),n.qZA()()()()),2&i){const t=n.oxw();n.xp6(1),n.Q6J("ngIf",t.plugin.funding),n.xp6(1),n.MGl("ngbTooltip","@",t.plugin.author,"")}}function D(i,l){if(1&i&&(n.TgZ(0,"span"),n._uU(1),n.ALo(2,"date"),n.qZA()),2&i){const t=n.oxw();n.xp6(1),n.hij("(",n.xi3(2,1,t.plugin.lastUpdated,"yyyy-MM-dd"),")")}}function V(i,l){if(1&i){const t=n.EpF();n.TgZ(0,"a",38),n.NdJ("click",function(){n.CHM(t);const a=n.oxw();return n.KtG(a.$plugin.settings(a.plugin))}),n._uU(1),n.ALo(2,"uppercase"),n.ALo(3,"translate"),n.qZA()}2&i&&(n.xp6(1),n.hij(" ",n.lcZ(2,1,n.lcZ(3,3,"plugins.button_settings"))," "))}function O(i,l){if(1&i){const t=n.EpF();n.TgZ(0,"a",39),n.NdJ("click",function(){n.CHM(t);const a=n.oxw();return n.KtG(a.$plugin.updatePlugin(a.plugin))}),n.ALo(1,"translate"),n._uU(2),n.ALo(3,"uppercase"),n.ALo(4,"translate"),n.qZA()}if(2&i){const t=n.oxw();n.s9C("ngbTooltip",n.xi3(1,3,"plugins.tooltip_update_plugin_to",t.plugin)),n.Q6J("translate","plugins.button_update"),n.xp6(2),n.hij(" ",n.lcZ(3,6,n.lcZ(4,8,"plugins.button_update"))," ")}}function E(i,l){if(1&i){const t=n.EpF();n.TgZ(0,"a",38),n.NdJ("click",function(){n.CHM(t);const a=n.oxw();return n.KtG(a.$plugin.installPlugin(a.plugin.name))}),n._uU(1),n.ALo(2,"uppercase"),n.ALo(3,"translate"),n.qZA()}2&i&&(n.xp6(1),n.hij(" ",n.lcZ(2,1,n.lcZ(3,3,"plugins.button_install"))," "))}function H(i,l){if(1&i){const t=n.EpF();n.TgZ(0,"a",44),n.NdJ("click",function(){n.CHM(t);const a=n.oxw(2);return n.KtG(a.$plugin.bridgeSettings(a.plugin))}),n.ALo(1,"translate"),n._UZ(2,"i",45),n.qZA()}2&i&&n.s9C("ngbTooltip",n.lcZ(1,1,"child_bridge.label_bridge_connect_to_homekit"))}function K(i,l){if(1&i){const t=n.EpF();n.TgZ(0,"a",46),n.NdJ("click",function(){n.CHM(t);const a=n.oxw(2);return n.KtG(a.doChildBridgeAction("restart"))}),n.ALo(1,"translate"),n._UZ(2,"i",47),n.qZA()}2&i&&n.s9C("ngbTooltip",n.lcZ(1,1,"child_bridge.label_bridge_restart_child_bridges"))}function R(i,l){1&i&&n._UZ(0,"i",48)}const G=function(i,l,t){return{"green-text":i,"text-warning":l,"red-text":t}};function z(i,l){if(1&i&&(n.ynx(0),n.YNc(1,H,3,3,"a",40),n._UZ(2,"i",41),n.YNc(3,K,3,3,"a",42),n.YNc(4,R,1,0,"i",43),n.BQk()),2&i){const t=n.oxw();n.xp6(1),n.Q6J("ngIf",!t.childBridgeRestartInProgress&&t.hasUnpairedChildBridges&&"ok"===t.childBridgeStatus),n.xp6(1),n.Q6J("ngClass",n.kEZ(4,G,"ok"===t.childBridgeStatus,"pending"===t.childBridgeStatus,"down"===t.childBridgeStatus)),n.xp6(1),n.Q6J("ngIf",!t.childBridgeRestartInProgress&&!t.plugin.disabled),n.xp6(1),n.Q6J("ngIf",t.childBridgeRestartInProgress)}}function X(i,l){if(1&i){const t=n.EpF();n.TgZ(0,"button",50),n.NdJ("click",function(){n.CHM(t);const a=n.oxw(2);return n.KtG(a.doChildBridgeAction("stop"))}),n._UZ(1,"i",51),n._uU(2," Stop Child Bridges "),n.qZA()}}function W(i,l){if(1&i){const t=n.EpF();n.TgZ(0,"button",50),n.NdJ("click",function(){n.CHM(t);const a=n.oxw(2);return n.KtG(a.doChildBridgeAction("start"))}),n._UZ(1,"i",52),n._uU(2," Start Child Bridges "),n.qZA()}}function nn(i,l){if(1&i&&(n.ynx(0),n.YNc(1,X,3,0,"button",20),n.YNc(2,W,3,0,"button",20),n._UZ(3,"div",49),n.BQk()),2&i){const t=n.oxw();n.xp6(1),n.Q6J("ngIf",!t.allChildBridgesStopped),n.xp6(1),n.Q6J("ngIf",t.allChildBridgesStopped)}}function tn(i,l){if(1&i){const t=n.EpF();n.TgZ(0,"button",50),n.NdJ("click",function(){n.CHM(t);const a=n.oxw();return n.KtG(a.$plugin.installPreviousVersion(a.plugin))}),n._UZ(1,"i",53),n._uU(2),n.ALo(3,"translate"),n.qZA()}2&i&&(n.xp6(2),n.hij(" ",n.lcZ(3,1,"plugins.manage.message_install_alternate_version")," "))}function en(i,l){if(1&i){const t=n.EpF();n.TgZ(0,"button",50),n.NdJ("click",function(){n.CHM(t);const a=n.oxw();return n.KtG(a.$plugin.bridgeSettings(a.plugin))}),n._UZ(1,"i",54),n._uU(2),n.ALo(3,"translate"),n.qZA()}2&i&&(n.xp6(2),n.hij(" ",n.lcZ(3,1,"child_bridge.label_bridge_settings")," "))}function an(i,l){if(1&i){const t=n.EpF();n.TgZ(0,"button",50),n.NdJ("click",function(){n.CHM(t);const a=n.oxw();return n.KtG(a.$plugin.jsonEditor(a.plugin))}),n._UZ(1,"i",55),n._uU(2),n.ALo(3,"translate"),n.qZA()}2&i&&(n.xp6(2),n.hij(" ",n.lcZ(3,1,"plugins.manage.json_config")," "))}function ln(i,l){if(1&i){const t=n.EpF();n.TgZ(0,"button",50),n.NdJ("click",function(){n.CHM(t);const a=n.oxw();return n.KtG(a.disablePlugin(a.plugin))}),n._UZ(1,"i",56),n._uU(2),n.ALo(3,"translate"),n.qZA()}2&i&&(n.xp6(2),n.hij(" ",n.lcZ(3,1,"plugins.manage.disable")," "))}function on(i,l){if(1&i){const t=n.EpF();n.TgZ(0,"button",50),n.NdJ("click",function(){n.CHM(t);const a=n.oxw();return n.KtG(a.enablePlugin(a.plugin))}),n._UZ(1,"i",57),n._uU(2),n.ALo(3,"translate"),n.qZA()}2&i&&(n.xp6(2),n.hij(" ",n.lcZ(3,1,"plugins.manage.enable")," "))}function sn(i,l){if(1&i){const t=n.EpF();n.TgZ(0,"button",50),n.NdJ("click",function(){n.CHM(t);const a=n.oxw();return n.KtG(a.$plugin.uninstallPlugin(a.plugin))}),n._UZ(1,"i",58),n._uU(2),n.ALo(3,"translate"),n.qZA()}2&i&&(n.xp6(2),n.hij(" ",n.lcZ(3,1,"plugins.button_uninstall")," "))}function rn(i,l){if(1&i&&(n.TgZ(0,"a",59),n._UZ(1,"i",60),n.qZA()),2&i){const t=n.oxw();n.Q6J("href",t.plugin.links.homepage||t.plugin.links.npm,n.LSH)("ngbTooltip",t.plugin.links.homepage||t.plugin.links.npm)}}let gn=(()=>{class i{constructor(t,e,a,s,d,h,_,b,hn){this.$plugin=t,this.$settings=e,this.$api=a,this.$ws=s,this.$notification=d,this.$translate=h,this.$modal=_,this.$toastr=b,this.$md=hn,this.io=this.$ws.getExistingNamespace("child-bridges"),this.canDisablePlugins=!1,this.canManageBridgeSettings=!1,this.isMobile=this.$md.detect.mobile(),this._childBridges=[],this.hasChildBridges=!1,this.hasUnpairedChildBridges=!1,this.allChildBridgesStopped=!1,this.childBridgeStatus="pending",this.childBridgeRestartInProgress=!1,this.canStopStartChildBridges=!1}ngOnInit(){this.canDisablePlugins=!!this.$settings.env.homebridgeVersion&&(0,m.gt)(this.$settings.env.homebridgeVersion,"1.3.0-beta.46",{includePrerelease:!0}),this.canManageBridgeSettings=!!this.$settings.env.homebridgeVersion&&(0,m.gt)(this.$settings.env.homebridgeVersion,"1.3.0-beta.47",{includePrerelease:!0}),this.canStopStartChildBridges=!!this.$settings.env.homebridgeVersion&&(0,m.gt)(this.$settings.env.homebridgeVersion,"1.5.0-beta.1",{includePrerelease:!0})}set childBridges(t){this.hasChildBridges=t.length>0,this.hasUnpairedChildBridges=t.filter(e=>!1===e.paired).length>0,this.allChildBridgesStopped=t.filter(e=>!0===e.manuallyStopped).length===t.length,this.hasChildBridges&&(t.some(e=>"down"===e.status)?this.childBridgeStatus="down":t.some(e=>"pending"===e.status)?this.childBridgeStatus="pending":t.some(e=>"ok"===e.status)&&(this.childBridgeStatus="ok")),this._childBridges=t}openFundingModal(t){this.$modal.open(J).componentInstance.plugin=t}disablePlugin(t){var e=this;const a=this.$modal.open(y.X);a.componentInstance.title=`${this.$translate.instant("plugins.manage.disable")}: ${t.name}`,a.componentInstance.message=this.$translate.instant("plugins.manage.message_confirm_disable",{pluginName:t.name}),a.componentInstance.confirmButtonLabel=this.$translate.instant("plugins.manage.disable"),a.componentInstance.cancelButtonLabel=this.$translate.instant("form.button_cancel"),a.result.then((0,u.Z)(function*(){try{yield e.$api.put(`/config-editor/plugin/${encodeURIComponent(t.name)}/disable`,{}).toPromise(),t.disabled=!0,e.hasChildBridges&&e.canStopStartChildBridges&&e.doChildBridgeAction("stop"),e.$toastr.success(e.$translate.instant("plugins.settings.toast_restart_required"),e.$translate.instant("toast.title_success")),e.$notification.configUpdated.next(void 0)}catch(s){e.$toastr.error(`Failed to disable plugin: ${s.message}`,e.$translate.instant("toast.title_error"))}})).finally(()=>{})}enablePlugin(t){var e=this;const a=this.$modal.open(y.X);a.componentInstance.title=`${this.$translate.instant("plugins.manage.enable")}: ${t.name}`,a.componentInstance.message=this.$translate.instant("plugins.manage.message_confirm_enable",{pluginName:t.name}),a.componentInstance.confirmButtonLabel=this.$translate.instant("plugins.manage.enable"),a.componentInstance.cancelButtonLabel=this.$translate.instant("form.button_cancel"),a.result.then((0,u.Z)(function*(){try{yield e.$api.put(`/config-editor/plugin/${encodeURIComponent(t.name)}/enable`,{}).toPromise(),t.disabled=!1,e.hasChildBridges&&e.canStopStartChildBridges&&e.doChildBridgeAction("start"),e.$toastr.success(e.$translate.instant("plugins.settings.toast_restart_required"),e.$translate.instant("toast.title_success")),e.$notification.configUpdated.next(void 0)}catch(s){e.$toastr.error(`Failed to enable plugin: ${s.message}`,e.$translate.instant("toast.title_error"))}})).finally(()=>{})}doChildBridgeAction(t){var e=this;return(0,u.Z)(function*(){e.childBridgeRestartInProgress=!0;try{for(const a of e._childBridges)yield e.io.request(t+"-child-bridge",a.username).toPromise()}catch(a){e.$toastr.error(`Failed to ${t} bridges: `+a?.message,e.$translate.instant("toast.title_error")),e.childBridgeRestartInProgress=!1}finally{setTimeout(()=>{e.childBridgeRestartInProgress=!1},"restart"===t?12e3:"stop"===t?6e3:1e3)}})()}}return i.\u0275fac=function(t){return new(t||i)(n.Y36(v.r),n.Y36(x.g),n.Y36(Z.s),n.Y36(P.r),n.Y36(U.g),n.Y36(p.sK),n.Y36(c.FF),n.Y36(T._W),n.Y36(N.L))},i.\u0275cmp=n.Xpm({type:i,selectors:[["app-plugin-card"]],inputs:{plugin:"plugin",childBridges:"childBridges"},decls:36,vars:28,consts:[[1,"card","card-body","mb-3"],[1,"d-flex","flex-row","justify-content-between"],[1,""],["class","mb-0 primary-text",3,"translate",4,"ngIf"],["class","mb-0 grey-text",3,"translate",4,"ngIf"],["class","mb-0 primary-text",4,"ngIf"],["class","mb-0 red-text",4,"ngIf"],["class","mb-0 grey-text text-right",4,"ngIf"],[1,"card-title","mb-0"],[1,"card-text"],[4,"ngIf"],[1,"d-flex"],["href","javascript:void(0)","class","card-link",3,"click",4,"ngIf"],["href","javascript:void(0)","class","card-link","placement","bottom","container","body","openDelay","150",3,"ngbTooltip","translate","click",4,"ngIf"],[1,"ml-auto"],["ngbDropdown","",1,"d-inline-block","ml-3"],["href","javascript:void(0)","aria-label","Plugin actions drop down menu","ngbDropdownToggle","",1,"card-link","grey-text"],[1,"card-link"],[1,"fas","fa-wrench"],["ngbDropdownMenu","","aria-labelledby","Plugin actions drop down menu"],["ngbDropdownItem","",3,"click",4,"ngIf"],["class","card-link grey-text ml-3","target","_blank","rel","noopener noreferrer","aria-label","Plugin homepage","placement","left","container","body","openDelay","150",3,"href","ngbTooltip",4,"ngIf"],[1,"mb-0","primary-text",3,"translate"],[1,"mb-0","grey-text",3,"translate"],[1,"mb-0","primary-text"],[1,"far","fa-arrow-alt-circle-up"],[1,"mb-0","red-text"],[1,"far","fa-times-circle"],[1,"mb-0","grey-text","text-right"],["target","_blank","rel","noopener noreferrer",1,"card-link","grey-text",3,"href"],["href","javascript:void(0)","class","card-link pink-text",3,"click",4,"ngIf"],["target","_blank","rel","noopener noreferrer","href","https://github.com/homebridge/homebridge/wiki/verified-Plugins",1,"card-link","grey-text",3,"ngbTooltip"],[1,"card-link","green-text"],[1,"fas","fa-shield-alt"],[1,"d-none","d-sm-inline"],["href","javascript:void(0)",1,"card-link","pink-text",3,"click"],[1,"card-link","pink-text"],[1,"fas","fa-heart"],["href","javascript:void(0)",1,"card-link",3,"click"],["href","javascript:void(0)","placement","bottom","container","body","openDelay","150",1,"card-link",3,"ngbTooltip","translate","click"],["href","javascript:void(0);","class","card-link grey-text","rel","noopener noreferrer","aria-label","Connect to HomeKit","placement","top","container","body","openDelay","150",3,"ngbTooltip","click",4,"ngIf"],[1,"fas","fa-circle","ml-3",3,"ngClass"],["href","javascript:void(0);","class","card-link grey-text ml-3","aria-label","Restart Child Bridges","placement","top","container","body","openDelay","150",3,"ngbTooltip","click",4,"ngIf"],["class","ml-3 grey-text fas fa-fw fa-spinner fa-pulse",4,"ngIf"],["href","javascript:void(0);","rel","noopener noreferrer","aria-label","Connect to HomeKit","placement","top","container","body","openDelay","150",1,"card-link","grey-text",3,"ngbTooltip","click"],[1,"fa-fw","icon-button","fas","fa-qrcode"],["href","javascript:void(0);","aria-label","Restart Child Bridges","placement","top","container","body","openDelay","150",1,"card-link","grey-text","ml-3",3,"ngbTooltip","click"],[1,"fa-fw","icon-button","fas","fa-power-off"],[1,"ml-3","grey-text","fas","fa-fw","fa-spinner","fa-pulse"],[1,"dropdown-divider"],["ngbDropdownItem","",3,"click"],[1,"fas","fa-fw","fa-stop"],[1,"fas","fa-fw","fa-play"],[1,"fas","fa-fw","fa-history"],[1,"fas","fa-fw","fa-project-diagram"],[1,"fas","fa-fw","fa-code"],[1,"far","fa-fw","fa-times-circle"],[1,"far","fa-fw","fa-check-circle"],[1,"fas","fa-fw","fa-trash"],["target","_blank","rel","noopener noreferrer","aria-label","Plugin homepage","placement","left","container","body","openDelay","150",1,"card-link","grey-text","ml-3",3,"href","ngbTooltip"],[1,"fas","fa-external-link-alt"]],template:function(t,e){1&t&&(n.TgZ(0,"div",0)(1,"div",1)(2,"div",2),n.YNc(3,Y,2,1,"p",3),n.YNc(4,S,2,1,"p",4),n.YNc(5,Q,4,3,"p",5),n.YNc(6,j,4,3,"p",6),n.qZA(),n.TgZ(7,"div",2),n.YNc(8,F,3,2,"p",7),n.YNc(9,q,7,2,"p",7),n.qZA()(),n.TgZ(10,"h4",8),n._uU(11),n.ALo(12,"titlecase"),n.ALo(13,"replace"),n.qZA(),n.TgZ(14,"p",9),n._uU(15),n.YNc(16,D,3,4,"span",10),n.qZA(),n.TgZ(17,"div",11),n.YNc(18,V,4,5,"a",12),n.YNc(19,O,5,10,"a",13),n.YNc(20,E,4,5,"a",12),n.TgZ(21,"div",14),n.YNc(22,z,5,8,"ng-container",10),n.TgZ(23,"span",15)(24,"a",16)(25,"span",17),n._UZ(26,"i",18),n.qZA()(),n.TgZ(27,"div",19),n.YNc(28,nn,4,2,"ng-container",10),n.YNc(29,tn,4,3,"button",20),n.YNc(30,en,4,3,"button",20),n.YNc(31,an,4,3,"button",20),n.YNc(32,ln,4,3,"button",20),n.YNc(33,on,4,3,"button",20),n.YNc(34,sn,4,3,"button",20),n.qZA()(),n.YNc(35,rn,2,2,"a",21),n.qZA()()()),2&t&&(n.xp6(3),n.Q6J("ngIf",e.plugin.installedVersion&&!e.plugin.updateAvailable&&!e.plugin.disabled),n.xp6(1),n.Q6J("ngIf",!e.plugin.installedVersion),n.xp6(1),n.Q6J("ngIf",e.plugin.updateAvailable&&!e.plugin.disabled),n.xp6(1),n.Q6J("ngIf",e.plugin.installedVersion&&e.plugin.disabled),n.xp6(2),n.Q6J("ngIf",e.plugin.author&&!e.plugin.verifiedPlugin),n.xp6(1),n.Q6J("ngIf",e.plugin.verifiedPlugin),n.xp6(2),n.hij(" ",e.plugin.displayName||n.lcZ(12,22,n.Dn7(13,24,"@"===e.plugin.name.charAt(0)?e.plugin.name.split("/")[1]:e.plugin.name,"-"," "))," "),n.xp6(4),n.AsE("",e.plugin.name," v",e.plugin.installedVersion||e.plugin.latestVersion," "),n.xp6(1),n.Q6J("ngIf",e.plugin.lastUpdated),n.xp6(2),n.Q6J("ngIf",e.plugin.installedVersion),n.xp6(1),n.Q6J("ngIf",e.plugin.updateAvailable),n.xp6(1),n.Q6J("ngIf",!e.plugin.installedVersion),n.xp6(2),n.Q6J("ngIf",e.hasChildBridges),n.xp6(6),n.Q6J("ngIf",e.canStopStartChildBridges&&e.hasChildBridges&&!e.plugin.disabled),n.xp6(1),n.Q6J("ngIf",e.plugin.publicPackage),n.xp6(1),n.Q6J("ngIf",e.plugin.installedVersion&&"homebridge-config-ui-x"!==e.plugin.name&&e.canManageBridgeSettings),n.xp6(1),n.Q6J("ngIf",!e.isMobile&&e.plugin.installedVersion&&"homebridge-config-ui-x"!==e.plugin.name),n.xp6(1),n.Q6J("ngIf",e.plugin.installedVersion&&"homebridge-config-ui-x"!==e.plugin.name&&!e.plugin.disabled&&e.canDisablePlugins),n.xp6(1),n.Q6J("ngIf",e.plugin.installedVersion&&"homebridge-config-ui-x"!==e.plugin.name&&e.plugin.disabled),n.xp6(1),n.Q6J("ngIf",e.plugin.installedVersion&&"homebridge-config-ui-x"!==e.plugin.name),n.xp6(1),n.Q6J("ngIf",e.plugin.links.homepage||e.plugin.links.npm))},dependencies:[g.mk,g.O5,p.Pi,c.jt,c.iD,c.Vi,c.TH,c._L,g.gd,g.rS,g.uU,p.X$,M]}),i})();function cn(i,l){1&i&&n._UZ(0,"app-spinner")}function pn(i,l){1&i&&n._UZ(0,"i",9)}function un(i,l){if(1&i&&(n.TgZ(0,"div",10),n._UZ(1,"app-plugin-card",11),n.qZA()),2&i){const t=l.$implicit,e=n.oxw();n.xp6(1),n.Q6J("plugin",t)("childBridges",e.getPluginChildBridges(t))}}const dn=[{path:"",component:(()=>{class i{constructor(t,e,a,s,d,h,_,b){this.$settings=t,this.$api=e,this.$ws=a,this.$plugin=s,this.$router=d,this.$route=h,this.$toastr=_,this.$translate=b,this.io=this.$ws.connectToNamespace("child-bridges"),this.installedPlugins=[],this.childBridges=[],this.form=new r.cw({query:new r.NI("",[r.kI.required])}),this.loading=!0}ngOnInit(){var t=this;return(0,u.Z)(function*(){t.io.connected.subscribe((0,u.Z)(function*(){t.getChildBridgeMetadata(),t.io.socket.emit("monitor-child-bridge-status")})),t.io.socket.on("child-bridge-status-update",e=>{const a=t.childBridges.find(s=>s.username===e.username);a?Object.assign(a,e):t.childBridges.push(e)}),t.navigationSubscription=t.$router.events.subscribe(e=>{e instanceof f.m2&&t.loadInstalledPlugins()}),yield t.loadInstalledPlugins()})()}loadInstalledPlugins(){var t=this;return(0,u.Z)(function*(){t.form.setValue({query:""}),t.installedPlugins=[],t.loading=!0;try{t.installedPlugins=yield t.$api.get("/plugins").toPromise(),t.loading=!1}catch(e){t.$toastr.error(`${t.$translate.instant("plugins.toast_failed_to_load_plugins")}: ${e.message}`,t.$translate.instant("toast.title_error"))}t.$route.queryParams.pipe((0,I.q)(1)).subscribe(function(){var e=(0,u.Z)(function*(a){if(a.installed&&t.installedPlugins.find(s=>s.name===a.installed)){const s=t.installedPlugins.find(d=>d.name===a.installed);t.$plugin.settings(s).then(d=>{t.recommendChildBridge(s,d)}).finally(()=>{t.$router.navigate([],{queryParams:{}})})}});return function(a){return e.apply(this,arguments)}}())})()}search(){this.installedPlugins=[],this.loading=!0,this.$api.get(`/plugins/search/${encodeURIComponent(this.form.value.query)}`).subscribe(t=>{this.installedPlugins=t,this.loading=!1},t=>{this.loading=!1,this.$toastr.error(`${t.error.message||t.message}`,"Error"),this.loadInstalledPlugins()})}onClearSearch(){this.form.setValue({query:""}),this.loadInstalledPlugins()}onSubmit({value:t}){t.query.length?this.search():this.loadInstalledPlugins()}recommendChildBridge(t,e){this.$settings.env.recommendChildBridges&&this.$settings.env.serviceMode&&(0,m.gt)(this.$settings.env.homebridgeVersion,"1.5.0-beta.1",{includePrerelease:!0})&&e&&"platform"===e.pluginType&&this.$plugin.bridgeSettings(t)}getChildBridgeMetadata(){this.io.request("get-homebridge-child-bridge-status").subscribe(t=>{this.childBridges=t})}getPluginChildBridges(t){return this.childBridges.filter(e=>e.plugin===t.name)}ngOnDestroy(){this.navigationSubscription&&this.navigationSubscription.unsubscribe(),this.io.end()}}return i.\u0275fac=function(t){return new(t||i)(n.Y36(x.g),n.Y36(Z.s),n.Y36(P.r),n.Y36(v.r),n.Y36(f.F0),n.Y36(f.gz),n.Y36(T._W),n.Y36(p.sK))},i.\u0275cmp=n.Xpm({type:i,selectors:[["app-plugins"]],decls:10,vars:7,consts:[[4,"ngIf"],[1,"row"],[1,"col-md-12"],["novalidate","",3,"formGroup","ngSubmit"],["type","text","formControlName","query",1,"hb-npm-search",3,"placeholder"],["href","javascript:void(0)",1,"hb-npm-search-clear",3,"click"],["class","far fa-times-circle",4,"ngIf"],[1,"d-flex","flex-wrap","justify-content-between"],["class","hb-plugin-space-between",4,"ngFor","ngForOf"],[1,"far","fa-times-circle"],[1,"hb-plugin-space-between"],[3,"plugin","childBridges"]],template:function(t,e){1&t&&(n.YNc(0,cn,1,0,"app-spinner",0),n.TgZ(1,"div",1)(2,"div",2)(3,"form",3),n.NdJ("ngSubmit",function(){return e.onSubmit(e.form)}),n._UZ(4,"input",4),n.ALo(5,"translate"),n.TgZ(6,"a",5),n.NdJ("click",function(){return e.onClearSearch()}),n.YNc(7,pn,1,0,"i",6),n.qZA()()()(),n.TgZ(8,"div",7),n.YNc(9,un,2,2,"div",8),n.qZA()),2&t&&(n.Q6J("ngIf",e.loading),n.xp6(3),n.Q6J("formGroup",e.form),n.xp6(1),n.Q6J("placeholder",n.lcZ(5,5,"plugins.placeholder_search_plugin")),n.xp6(3),n.Q6J("ngIf",e.form.controls.query.value),n.xp6(2),n.Q6J("ngForOf",e.installedPlugins))},dependencies:[g.sg,g.O5,r._Y,r.Fj,r.JJ,r.JL,r.sg,r.u,A.O,gn,p.X$],styles:[".hb-npm-search[_ngcontent-%COMP%]{outline:none;box-sizing:inherit!important;border:1px solid #d0d0d0;background-color:inherit;height:50px!important;width:100%;border-width:.5px;padding:10px;margin-bottom:15px}@media (hover: hover){.hb-npm-search[_ngcontent-%COMP%]:hover{border:1px solid #000000}}.hb-npm-search[_ngcontent-%COMP%]:focus{border:1px solid #000000;box-shadow:0 1px #000}.hb-npm-search-clear[_ngcontent-%COMP%]{position:absolute;right:25px;font-size:35px;color:#d0d0d0;line-height:50px;cursor:pointer}.hb-plugin-space-between[_ngcontent-%COMP%]{box-sizing:border-box;width:calc(50% - 6.6666666667px)}@media only screen and (max-width: 991px){.hb-plugin-space-between[_ngcontent-%COMP%]{width:calc(100% - 6.6666666667px)}}"]}),i})()}];let fn=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=n.oAB({type:i}),i.\u0275inj=n.cJS({imports:[f.Bz.forChild(dn),f.Bz]}),i})(),mn=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=n.oAB({type:i}),i.\u0275inj=n.cJS({imports:[g.ez,r.u5,r.UX,p.aw.forChild(),c.IJ,k.I,$.E,fn]}),i})()}}]);