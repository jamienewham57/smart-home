"use strict";(self.webpackChunkui=self.webpackChunkui||[]).push([[853],{47853:(k,m,i)=>{i.r(m),i.d(m,{LinuxModule:()=>Z});var u=i(36895),o=i(54463),v=i(40294),a=i(57750),t=i(94650),g=i(79274),x=i(45417),f=i(92503),d=i(97185),_=i(48703);function w(e,r){1&e&&t._UZ(0,"app-spinner")}function T(e,r){1&e&&(t.TgZ(0,"p",6),t._uU(1,"Please wait, this page will automatically redirect when the Homebridge is back online."),t.qZA()),2&e&&t.Q6J("translate","platform.linux.restart.message_please_wait_while_server_restarts")}function y(e,r){if(1&e&&(t.TgZ(0,"p",7),t._uU(1),t.qZA()),2&e){const s=t.oxw();t.xp6(1),t.Oqu(s.error)}}function $(e,r){1&e&&(t.TgZ(0,"div")(1,"p",6),t._uU(2,"Server restart is taking a long time. You may need to bring up the server back up manually."),t.qZA()()),2&e&&(t.xp6(1),t.Q6J("translate","platform.linux.restart.message_server_taking_long_time_to_restart"))}function C(e,r){1&e&&(t.TgZ(0,"p",5),t._uU(1,"The server will power down shortly."),t.qZA()),2&e&&t.Q6J("translate","platform.linux.shutdown.message_server_will_power_down")}function S(e,r){if(1&e&&(t.TgZ(0,"p",6),t._uU(1),t.qZA()),2&e){const s=t.oxw();t.xp6(1),t.Oqu(s.error)}}const Y=[{path:"",redirectTo:"/",pathMatch:"full"},{path:"restart-server",component:(()=>{class e{constructor(s,n,l,c,h,p){this.$api=s,this.$ws=n,this.$settings=l,this.$toastr=c,this.translate=h,this.$router=p,this.io=this.$ws.connectToNamespace("status"),this.resp={},this.timeout=!1,this.error=!1}ngOnInit(){this.io.connected.subscribe(()=>{this.io.socket.emit("monitor-server-status"),this.$settings.getAppSettings().catch()}),this.$api.put("/platform-tools/linux/restart-host",{}).subscribe(s=>{this.resp=s,this.checkIfServerUp()},s=>{this.error=this.translate.instant("platform.linux.restart.toast_server_restart_error"),this.$toastr.error(`${this.error}: ${s.message}`,this.translate.instant("toast.title_error"))})}checkIfServerUp(){this.checkDelay=setTimeout(()=>{this.io.socket.on("homebridge-status",s=>{("up"===s.status||"pending"===s.status)&&(this.$toastr.success(this.translate.instant("platform.linux.restart.toast_server_restarted"),this.translate.instant("toast.title_success")),this.$router.navigate(["/"]))})},3e4),this.checkTimeout=setTimeout(()=>{this.$toastr.warning(this.translate.instant("platform.linux.restart.toast_server_taking_long_time_to_come_online"),this.translate.instant("toast.title_warning"),{timeOut:1e4}),this.timeout=!0},12e4)}ngOnDestroy(){this.io.end(),clearTimeout(this.checkDelay),clearTimeout(this.checkTimeout)}}return e.\u0275fac=function(s){return new(s||e)(t.Y36(g.s),t.Y36(x.r),t.Y36(f.g),t.Y36(d._W),t.Y36(o.sK),t.Y36(a.F0))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-restart-linux"]],decls:8,vars:5,consts:[[4,"ngIf"],[1,"row"],[1,"col-md-12","text-center"],[1,"primary-text",3,"translate"],["class","grey-text",3,"translate",4,"ngIf"],["class","grey-text",4,"ngIf"],[1,"grey-text",3,"translate"],[1,"grey-text"]],template:function(s,n){1&s&&(t.YNc(0,w,1,0,"app-spinner",0),t.TgZ(1,"div",1)(2,"div",2)(3,"h3",3),t._uU(4,"Restarting Server"),t.qZA(),t.YNc(5,T,2,1,"p",4),t.YNc(6,y,2,1,"p",5),t.YNc(7,$,3,1,"div",0),t.qZA()()),2&s&&(t.Q6J("ngIf",!n.error),t.xp6(3),t.Q6J("translate","platform.linux.restart.title_restarting_server"),t.xp6(2),t.Q6J("ngIf",!n.timeout&&!n.error),t.xp6(1),t.Q6J("ngIf",n.error),t.xp6(1),t.Q6J("ngIf",n.timeout))},dependencies:[u.O5,o.Pi,_.O]}),e})()},{path:"shutdown-server",component:(()=>{class e{constructor(s,n,l,c,h,p){this.$api=s,this.$ws=n,this.$settings=l,this.$toastr=c,this.translate=h,this.$router=p,this.io=this.$ws.connectToNamespace("status"),this.resp={},this.timeout=!1,this.error=!1}ngOnInit(){this.io.connected.subscribe(()=>{this.io.socket.emit("monitor-server-status"),this.$settings.getAppSettings().catch()}),this.$api.put("/platform-tools/linux/shutdown-host",{}).subscribe(s=>{this.resp=s,this.checkIfServerUp()},s=>{this.error=this.translate.instant("platform.linux.restart.toast_server_restart_error"),this.$toastr.error(`${this.error}: ${s.message}`,this.translate.instant("toast.title_error"))})}checkIfServerUp(){this.checkDelay=setTimeout(()=>{this.io.socket.on("homebridge-status",s=>{("up"===s.status||"pending"===s.status)&&(this.$toastr.success(this.translate.instant("platform.linux.restart.toast_server_restarted"),this.translate.instant("toast.title_success")),this.$router.navigate(["/"]))})},3e4),this.checkTimeout=setTimeout(()=>{this.$toastr.warning(this.translate.instant("platform.linux.restart.toast_server_taking_long_time_to_come_online"),this.translate.instant("toast.title_warning"),{timeOut:1e4}),this.timeout=!0},12e4)}ngOnDestroy(){this.io.end(),clearTimeout(this.checkDelay),clearTimeout(this.checkTimeout)}}return e.\u0275fac=function(s){return new(s||e)(t.Y36(g.s),t.Y36(x.r),t.Y36(f.g),t.Y36(d._W),t.Y36(o.sK),t.Y36(a.F0))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-shutdown-linux"]],decls:6,vars:3,consts:[[1,"row"],[1,"col-md-12","text-center"],[1,"primary-text",3,"translate"],["class","grey-text",3,"translate",4,"ngIf"],["class","grey-text",4,"ngIf"],[1,"grey-text",3,"translate"],[1,"grey-text"]],template:function(s,n){1&s&&(t.TgZ(0,"div",0)(1,"div",1)(2,"h3",2),t._uU(3,"Shutting Down Server "),t.qZA(),t.YNc(4,C,2,1,"p",3),t.YNc(5,S,2,1,"p",4),t.qZA()()),2&s&&(t.xp6(2),t.Q6J("translate","platform.linux.shutdown.title_shutting_down_server"),t.xp6(2),t.Q6J("ngIf",!n.timeout&&!n.error),t.xp6(1),t.Q6J("ngIf",n.error))},dependencies:[u.O5,o.Pi]}),e})()}];let I=(()=>{class e{}return e.\u0275fac=function(s){return new(s||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[a.Bz.forChild(Y),a.Bz]}),e})(),Z=(()=>{class e{}return e.\u0275fac=function(s){return new(s||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[u.ez,o.aw.forChild(),v.I,I]}),e})()}}]);